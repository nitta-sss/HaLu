{% load static %}
<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <title>Halu UI</title>
        <link rel="stylesheet" href="{% static 'CSS/style.css' %}">
    </head>

    <body>

        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <div class="header">
            <!-- Â∑¶‰∏ä„ÅÆ„Ç¢„Ç§„Ç≥„É≥ -->
            <div class="user-box">

                <!-- „Ç¢„Ç§„Ç≥„É≥„ÅÆÁîªÂÉè -->
                <img src="{% static 'img/face.png' %}" class="icon">
                <span class="username">Halu</span>

                <!-- „Ç≤„Éº„Ç∏Ë°®Á§∫ÂàáÊõø„Éú„Çø„É≥ -->
                <button id="toggle-btn">„Ç≤„Éº„Ç∏ÈùûË°®Á§∫</button>

            </div>
        </div>


        <div class="container">

            <!-- ‚òÖ‚òÖ‚òÖ Â∑¶„Ç®„É™„Ç¢ ‚òÖ‚òÖ‚òÖ -->
            <div class="left-area">
                <div class="chat-box">

                    <!-- messages „Å®„ÅÑ„ÅÜ„É™„Çπ„ÉàÔºàÈÖçÂàóÔºâ„Åã„Çâ1„Å§„Åö„Å§ msg „Å´Âèñ„ÇäÂá∫„Åó„Å¶‰Ωø„Å£„Å¶„ÅÑ„ÇãforÊñá -->
                    {% for msg in messages %}
                        <!-- CSS „Åß user „Å® bot „ÅÆÂêπ„ÅçÂá∫„Åó„Éá„Ç∂„Ç§„É≥„ÇíÂàÜ„Åë„Çã -->
                        <div class="balloon {{ msg.sender }}">
                            <!-- „ÉÜ„Ç≠„Çπ„ÉàË°®Á§∫ -->
                            {{ msg.text }}
                        </div>
                    {% endfor %}

                </div>

                <!-- Èü≥Â£∞ÂÖ•Âäõ„Éú„Çø„É≥ -->
                <div class="speak-icon">
                    üó£
                </div>

            </div>

            <!-- ‚òÖ‚òÖ‚òÖ Âè≥„Ç®„É™„Ç¢ ‚òÖ‚òÖ‚òÖ -->
            <div class="right-area">

                <!-- Âè≥ÁîªÈù¢ËÉåÊôØÁîªÂÉè -->
                <img src="{% static 'img/windows.jpg' %}" class="right-back">

                <!-- HaLu„ÅÆÈ°îÁîªÂÉè -->
                <div class="face-area">
                    <img src="{% static 'img/HaLu_Face.png' %}" class="face-img">
                </div>
            
                <!-- ÊÑüÊÉÖ„Ç≤„Éº„Ç∏ -->
                <div class="emotion-area fade" id="emotionArea">

                    <!-- Ë¶öÈÜíÂ∫¶„Éê„Éº -->
                    <div class="bar-item">
                        <div class="fade show">
                            <div class="bar-label">
                                Ë¶öÈÜíÂ∫¶
                            </div>
                        </div>
                        <div class="bar-base">
                            <div class="bar-fill fill1" id="awakeBar"></div>
                        </div>
                    </div>

                    <!-- Âø´Ê•ΩÂ∫¶„Éê„Éº -->
                    <div class="bar-item">
                        <div class="bar-label">
                            Âø´Ê•ΩÂ∫¶
                        </div>
                        <div class="bar-base" class="fade show">
                            <div class="bar-fill fill2" id="pleasureBar"></div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <script>
        document.addEventListener("DOMContentLoaded", function () {

            const awakeBar = document.getElementById("awakeBar");
            const pleasureBar = document.getElementById("pleasureBar");

            let emotion = {
                x: 20,
                y: 80
            };

            function updateGauge() {
                awakeBar.style.width = emotion.x + "%";
                pleasureBar.style.width = emotion.y + "%";
                updateGaugeColors(emotion.x, emotion.y);
            }

            updateGauge();

            setInterval(function () {
                emotion.x = Math.floor(Math.random() * 101);
                emotion.y = Math.floor(Math.random() * 101);
                updateGauge();
            }, 3000);

            /* ‚òÖ Ëâ≤Â§âÂåñ„ÅÆÈñ¢Êï∞ ‚òÖ */
            function updateGaugeColors(x, y) {

                /* --- Ë¶öÈÜíÂ∫¶ÔºöËµ§‚Üí„Ç™„É¨„É≥„Ç∏‚ÜíÈªÑ --- */
                let v1 = x / 100;
            let r1 = Math.round(255 * v1);
            let b1 = Math.round(255 * (1 - v1));
            let color1 = `rgb(${r1}, 0, ${b1})`;

            awakeBar.style.background = `linear-gradient(to right, ${color1}, #ffffff60)`;


            /* --- Âø´Ê•ΩÂ∫¶Ôºà‚òÖËµ§‚Üí„Ç™„É¨„É≥„Ç∏‚ÜíÈªÑÔºâ --- */
            if (y < 30) {
                pleasureBar.style.background = "linear-gradient(to right, red, orange)";
            } else if (y < 70) {
                pleasureBar.style.background = "linear-gradient(to right, orange, yellow)";
            } else {
                pleasureBar.style.background = "linear-gradient(to right, yellow, lightyellow)";
            }
        }

            /* ‚ñº‚ñº „Ç≤„Éº„Ç∏Ë°®Á§∫/ÈùûË°®Á§∫„Éú„Çø„É≥ ‚ñº‚ñº */
            const btn = document.getElementById("toggle-btn");
            const gauge = document.getElementById("emotionArea");

            btn.addEventListener("click", function () {
                gauge.classList.toggle("hide");
                btn.textContent = gauge.classList.contains("hide") ? "„Ç≤„Éº„Ç∏Ë°®Á§∫" : "„Ç≤„Éº„Ç∏ÈùûË°®Á§∫";
            });

        });  
        </script>

    </body>
</html>